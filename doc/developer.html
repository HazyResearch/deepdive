<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="DeepDive" />
    <link href='http://fonts.googleapis.com/css?family=Lato:300,400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="http://deepdive.stanford.edu/stylesheets/application.css" />
    <link rel="canonical" href="http://deepdive.stanford.edu">
    <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
    <script src="http://deepdive.stanford.edu/javascripts/application.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeepDive</title>
  </head>

  <body>
      <script type="text/javascript">
window.analytics||(window.analytics=[]),window.analytics.methods=["identify","track","trackLink","trackForm","trackClick","trackSubmit","page","pageview","ab","alias","ready","group","on","once","off"],window.analytics.factory=function(t){return function(){var a=Array.prototype.slice.call(arguments);return a.unshift(t),window.analytics.push(a),window.analytics}};for(var i=0;i<window.analytics.methods.length;i++){var method=window.analytics.methods[i];window.analytics[method]=window.analytics.factory(method)}window.analytics.load=function(t){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=("https:"===document.location.protocol?"https://":"http://")+"d2dq2ahtl5zl1z.cloudfront.net/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n)},window.analytics.SNIPPET_VERSION="2.0.8",
window.analytics.load("h6uwk48gwg");
window.analytics.page();
</script>
      <a href="https://github.com/hazyresearch/deepdive" target="_blank"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub"></a>

      <div id="header">
        <div class="container">
          <row>
            <div class="col-md-4 col-md-offset-1">
              <a href="http://deepdive.stanford.edu/" class="deepdive-logo">
              <img src="http://deepdive.stanford.edu/images/header_logo.png" style="width: 250px;"/>
              </a> 
            </div>
            <div class="col-md-6 col-md-offset-1">
              <ul class="list-unstyled list-inline" id="header-nav">
                <li><a href="http://deepdive.stanford.edu/index.html">Home</a></li>
                <li><a href="http://deepdive.stanford.edu/doc/installation.html">Download</a></li>
                <li><a href="http://deepdive.stanford.edu/index.html#documentation">Documentation</a></li>
                <li><a href="https://mailman.stanford.edu/mailman/listinfo/deepdive-list" target="_blank">Mailing List</a></li>
              </ul>
              
            </div>
          </row>
        </div>
      </div>

      <section id="main">
        <div class="container">
          <row>
            <div class="col-md-10 col-md-offset-1">
              <h1>Developer Guide &amp; System Architecture</h1>

<p>DeepDive is written using the following frameworks and libraries:</p>

<ul>
<li><a href="http://www.scala-lang.org/">Scala (2.10)</a> </li>
<li><a href="http://akka.io/">Akka</a> for concurrent programming using actors</li>
<li><a href="http://www.scalatest.org/">Scalatest</a> (and Akka&#39;s Testkit) for unit- and integration testing</li>
<li><a href="http://rxscala.github.io/">RxScala</a> and <a href="https://github.com/Netflix/RxJava">RxJava</a> for Observables</li>
<li><a href="http://www.playframework.com/documentation/2.2.1/ScalaAnorm">Anorm</a> for RDBMS access</li>
<li><a href="http://www.scala-sbt.org/">SBT</a> for dependency management</li>
</ul>

<h3>Style Guide</h3>

<p>Please follow the <a href="http://docs.scala-lang.org/style/">Scala Style Guide</a> when contributing.</p>

<h3>Compiling</h3>

<p>You must install <a href="http://www.scala-sbt.org/">SBT</a> to compile DeepDive. On Mac OS X, you can install SBT using <a href="http://brew.sh/">Homebrew</a>. You can then compile DeepDive using the following command in the root directory. SBT should download all required dependencies (including Scala) for you.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">sbt compile
</code></pre></div>
<p>During development we recommend running <code>sbt ~compile</code> instead. The tilde will automatically watch the directory for changes, and recompile modified files.</p>

<h3>Running Tests</h3>

<p>DeepDive comes with a number of unit- and integration test. For tests that require connection to a database (such as PostgreSQL), you must modify the <code>src/test/recources/application.conf</code> file with your connection parameters. You can run all tests with:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">sbt test
</code></pre></div>
<p>To run a specific test, you can use:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">sbt &quot;test-only org.deepdive.test.unit.[TestClassName]&quot;
</code></pre></div>
<p>You can use <code>sbt ~test</code> to keep running tests in the background while you are modifying files.</p>

<h3>Reference: Factor Graph Output Schema</h3>

<p>DeepDive uses a custom binary format to encode the factor graph. It generates four files: One for weights, variables, factors, and edges. All of the files can be found in the out/ directory of the latest run. The format of these files is as follows (numbers are in bytes):</p>

<p>Weights: </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">weightId        long    8
isFixed         bool    1
initialValue    double  8
</code></pre></div>
<p>Variables:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">variableId      long    8
isEvidence      bool    1
initialValue    double  8
dataType        short   2
edgeCount*      long    8
cardinality     long    8
</code></pre></div>
<p>Factors</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">factorId        long    8
weightId        long    8
factorFunction  short   2
edgeCount       long    8
</code></pre></div>
<p>Edges</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">variableId      long    8
factorId        long    8
position        long    8
isPositive      bool    1
equalPredicate  long    8
</code></pre></div>
<p>*Note: from <a href="changelog/0.03-alpha.html">version 0.03</a>, the edgeCount field in Variables is always -1.</p>

<p>The systems also generates a metadata file of the following. The metadata file contains one comma-separated line with the following fields:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">Number of weights
Number of variables
Number of factors
Number of edges
Path to weights file
Path to variables file
Path to factors file
Path to edges file
</code></pre></div>
            </div>
          </row>
        </div>
      </section>
    
      <footer id="footer">
        <div class="container">
          <row>
            <div class="col-md-10 col-md-offset-1">
              <p class="pull-left"> 
                Copyright, 2014 deepdive.stanford.edu
                â‹…
                <a href="mailto:contact.hazy@gmail.com">Questions? Email us</a>
              </p>
              <p class="pull-right"> 
                Visit DeepDive on <a href="https://github.com/hazyresearch/deepdive" target="_blank">Github</a> 
              </p>
            </div>
          </row>
        </div>
      </footer>

    
  
  </body>
</html>
